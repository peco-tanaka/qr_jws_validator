# qr_jws_validator

> チケット入場管理システム用JWS検証機能の事前検証アプリ

## 目的・背景

本アプリケーションは、**チケット入場管理アプリ**に実装予定のJWS署名付きQRコード検証機能を事前にテストするためのプロトタイプです。
実際の本番環境への導入前に、JWS検証ロジックの動作確認と機能検証を行うことを主目的としています。

**注意**: 本アプリは機能検証に重点を置いており、パフォーマンス最適化や本格的なエラーハンドリングは実装していません。

## 概要

QRコードにエンコードされたチケット情報（JWS形式）をリアルタイムで読み取り、署名の検証を行うモバイルアプリケーションです。
チケットの真正性と整合性を迅速に確認できます。

## 主な機能

### QRコード読み取り

- **外付けUSBキーボードQRコードリーダー**: 専用のUSBキーボード型QRコードリーダーを使用
- **HardwareKeyboard対応**: FlutterのHardwareKeyboardクラスでキーボード入力として文字列を受信
- **即座に検証実行**: QRコード読み取り完了と同時にJWS検証を自動実行

### JWS署名検証

- **対応アルゴリズム**: ES256（ECDSA using P-256 and SHA-256）
- **公開鍵管理**: アプリケーションに事前組み込み済み
- **高速検証**: 楕円曲線暗号による効率的な署名検証

### 結果表示

- **リアルタイム表示**: トップ画面で検証結果を即座に表示
- **明確な結果**: 検証成功/失敗を視覚的に判別可能
- **シンプルUI**: 直感的で使いやすいインターフェース

## 技術仕様

### JWSペイロード構造

チケット情報を含むJWSペイロードは以下の構造を想定しています：

```json
{
  "ticket_id": "string",
  "ticket_type": "string",
  "sponsorship_ticket": "boolean"
}
```

#### フィールド詳細

- **ticket_id**: チケットの一意識別子
- **ticket_type**: チケットの種別（大人、小人）
- **sponsorship_ticket**: 協賛チケットかどうかのフラグ

### 署名仕様

- **フレームワーク**: Flutter
- **言語**: Dart
- **署名アルゴリズム**: ES256（ECDSA using P-256 and SHA-256）のみサポート
- **公開鍵**: アプリケーション内に静的に埋め込み
- **プラットフォーム**: Android

### QRコード読み取り仕様

- **入力デバイス**: 外付けUSBキーボード型QRコードリーダー
- **入力処理**: FlutterのHardwareKeyboardクラスを使用
- **データ受信**: キーボード入力イベントとして文字列を受信
- **自動処理**: Enter/改行文字で読み取り完了を検知し、自動でJWS検証を開始

### エラーハンドリング方針

機能検証を主目的とするため、エラーハンドリングは最低限の実装とします：

- USBキーボードQRコードリーダー接続失敗時の基本的な通知
- 無効な文字列入力時の警告表示
- JWS検証失敗時の結果表示
- 致命的エラー時のアプリクラッシュ防止

### パフォーマンス要件

本アプリは機能検証に重点を置いているため、パフォーマンス最適化は考慮しません。
必要最低限の動作保証のみを目標とします。

## ライブラリ

- jose_plus: JWSの検証を行うために使用
